{% extends "customer/customer_base.html" %}

{% block title %}Customer Overview{% endblock %}

{% block dashboard_content %}

    <div class="p-4 sm:p-6 lg:p-8 w-full max-w-[900px] mx-auto space-y-4">
        <header class="flex justify-between items-center w-full w-full h-14 mx-auto mb-6 pl-4 pr-4 pt-4">
            <div class="flex flex-col justify-start items-start h-auto w-full sm:w-auto pl-2">
                <h1 class="text-xl font-bold text-gray-900">My Overview</h1>
                <p class="text-xs text-gray-600">A summary of you records</p>
            </div>
            <!-- Stats Section -->
            <div class="flex flex-wrap gap-3 justify-start sm:justify-end w-full sm:w-auto">
                <!-- Pending Orders -->
                <div class="flex items-center gap-2 bg-amber-50 text-amber-800 px-3 py-1 border rounded-lg">
                    <p class="text-lg font-bold">{{ preparing_orders }}</p>
                    <p class="text-sm font-medium truncate">Orders in Progress</p>
                </div>
                <!-- Upcoming Reservations -->
                <div class="flex items-center gap-2 bg-purple-50 text-purple-800 px-3 py-1 border rounded-lg">
                    <p class="text-lg font-bold">{{ upcoming_reservations }}</p>
                    <p class="text-sm font-medium truncate">Upcoming Reservations</p>
                </div>
            </div>
        </header>

        <div class="flex flex-col md:flex-row md:items-start w-full gap-4">
            <!-- Orders -->
            <div class="flex flex-col w-full md:w-1/2 overflow-hidden rounded-xl bg-white border border-gray-200 shadow-sm ">
                <div class="flex flex-nowrap justify-between items-center px-8 py-5 border-b border-gray-200">
                    <p class="text-xl font-semibold text-gray-900 truncate mr-2">Your Orders</p>
                    <a href="{% url 'my_orders' %}" class="text-sm font-medium text-orange-400 hover:text-orange-800 border border-orange-400 rounded-lg px-4 py-2">View All</a>
                </div>

                <div class="flex flex-col p-6 space-y-4 h-[360px]">
                    <div class="flex flex-col space-y-4 flex-grow overflow-y-auto hide-scrollbar">
                        {% for order in recent_orders %}
                        <!-- Added onclick redirect and cursor-pointer -->
                        <div onclick="window.location.href='{% url 'my_orders' %}#order-{{ order.order_id_str }}'"
                             class="flex flex-col w-full p-4 rounded-lg bg-white border border-gray-200 space-y-2 cursor-pointer hover:bg-orange-50 hover:border-orange-400 transition-all duration-200 group">
                            <div class="flex flex-col gap-1">
                                <div class="flex justify-between items-center">
                                    <p class="text-base font-medium text-gray-900 group-hover:text-orange-700 transition-colors">#{{ order.order_id_str }}</p>
                                    <p class="text-sm text-gray-500">{{ order.order_date|date:"Y-m-d" }}</p>
                                </div>
                                <p class="text-sm text-gray-600 truncate">{{ order.get_item_summary }}</p>
                                <div class="flex justify-between items-center">
                                    <p class="text-base text-green-600">Rs {{ order.total|floatformat:2 }}</p>
                                    <div>
                                    <span class="text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded-lg">{{order.order_type}}</span>
                                    {% if order.status == 'Completed' %}<span class="text-xs text-green-600 bg-green-100 px-2 py-1 rounded-lg">Completed</span>
                                    {% elif order.status == 'Pending' %}<span class="text-xs text-yellow-600 bg-yellow-100 px-2 py-1 rounded-lg">Pending</span>
                                    {% elif order.status == 'Preparing' %}<span class="text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded-lg">Preparing</span>
                                    {% elif order.status == 'Cancelled' %}<span class="text-xs text-red-600 bg-red-100 px-2 py-1 rounded-lg">Cancelled</span>
                                    {% else %}<span class="text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded-lg">{{ order.status }}</span>
                                    {% endif %}
                                    </div>

                                </div>
                            </div>
                        </div>
                        {% empty %}
                        <p class="text-center text-gray-500 p-8">No recent orders.</p>
                        {% endfor %}
                        <a href="{% url 'menu:menu_starters' %}" class="p-6 rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 flex justify-center items-center hover:bg-gray-100 transition duration-150 cursor-pointer">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
            <!-- Reservations -->
            <div class="flex flex-col w-full md:w-1/2 overflow-hidden rounded-xl bg-white border border-gray-200 shadow-sm ">
                <div class="flex flex-nowrap justify-between items-center px-8 py-5 border-b border-gray-200">
                    <p class="text-xl font-semibold text-gray-900 truncate mr-2">Your Reservations</p>
                    <a href="{% url 'my_reservations' %}" class="text-sm font-medium text-orange-400 hover:text-orange-800 border border-orange-400 rounded-lg px-4 py-2 truncate">View All</a>
                </div>

                <div class="flex flex-col p-6 space-y-4 h-[360px]">
                    <div class="flex flex-col space-y-4 flex-grow overflow-y-auto hide-scrollbar">
                        {% for res in recent_reservations %}
                        <!-- Added onclick redirect and cursor-pointer -->
                        <div onclick="window.location.href='{% url 'my_reservations' %}#reservation-{{ res.reservation_id }}'"
                             class="flex flex-col w-full p-4 rounded-lg bg-white border border-gray-200 space-y-2 cursor-pointer hover:bg-orange-50 hover:border-orange-400 transition-all duration-200 group">
                            <div class="flex flex-col gap-1">
                                <div class="flex justify-between items-center">
                                    <p class="text-base font-medium text-gray-900 group-hover:text-orange-700 transition-colors">#RES-{{ res.reservation_id }}</p>
                                    <p class="text-sm text-gray-500">{{ res.date|date:"Y-m-d" }}</p>
                                </div>
                                <p class="text-sm text-gray-600">{{ res.time|time:"g:i A" }}</p>
                                <div class="flex justify-between items-center">
                                    <p class="text-base text-gray-700">{% if res.table_id.table_number %}Table {{ res.table_id.table_number }}{% else %}TBD{% endif %}</p>
                                    {% if res.status == 'confirmed' %}
                                        <span class="text-xs text-green-600 bg-green-100 px-2 py-1 rounded-lg">Confirmed</span>
                                    {% elif res.status == 'pending' %}
                                        <span class="text-xs text-yellow-600 bg-yellow-100 px-2 py-1 rounded-lg">Pending</span>
                                    {% elif res.status == 'completed' %}
                                        <span class="text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded-lg">Completed</span>
                                    {% elif res.status == 'cancelled' %}
                                        <span class="text-xs text-red-600 bg-red-100 px-2 py-1 rounded-lg">Cancelled</span>
                                    {% else %}
                                        <span class="text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded-lg">{{ res.status }}</span>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        {% empty %}
                        <p class="text-center text-gray-500 p-8">No recent reservations.</p>
                        {% endfor %}
                        <a href="{% url 'reservations:reservations' %}" class="p-6 rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 flex justify-center items-center hover:bg-gray-100 transition duration-150 cursor-pointer">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>

        </div>

        <div class="flex flex-col justify-center items-start w-full h-auto overflow-hidden p-6 rounded-xl bg-white border border-gray-200 shadow-sm">

            <div class="flex flex-wrap justify-start items-start flex-grow-0 flex-shrink-0 w-full h-auto gap-4">
                <a href="{% url 'menu:menu_starters' %}" class="flex flex-col justify-start items-center flex-1 h-[92px] min-w-[150px] p-4 rounded-lg bg-blue-100 hover:bg-blue-200 transition duration-300 cursor-pointer">
                    <div class="flex justify-start items-start flex-grow-0 flex-shrink-0 pb-2">
                        <div class="flex justify-center items-center flex-grow-0 flex-shrink-0 w-[25px] h-8 relative">
                        <svg width="26" height="24" viewBox="0 0 26 24" fill="none" xmlns="http://www.w3.org/2000/svg"
                            class="flex-grow-0 flex-shrink-0 w-[25px] h-6 absolute left-0 top-1" preserveAspectRatio="none">
                            <path
                                d="M4.64001 15.5V3.5H2.64001V1.5H5.64001C5.92001 1.5 6.15668 1.59667 6.35001 1.79C6.54335 1.98333 6.64001 2.22 6.64001 2.5V14.5H19.08L21.08 6.5H8.64001V4.5H22.36C22.64 4.5 22.8767 4.59667 23.07 4.79C23.2633 4.98333 23.36 5.22 23.36 5.5C23.36 5.58 23.3467 5.66 23.32 5.74L20.82 15.74C20.7667 15.9667 20.65 16.15 20.47 16.29C20.29 16.43 20.0867 16.5 19.86 16.5H5.64001C5.36001 16.5 5.12335 16.4033 4.93001 16.21C4.73668 16.0167 4.64001 15.78 4.64001 15.5ZM6.64001 22.5C6.28001 22.5 5.94668 22.41 5.64001 22.23C5.33335 22.05 5.09001 21.8067 4.91001 21.5C4.73001 21.1933 4.64001 20.86 4.64001 20.5C4.64001 20.14 4.73001 19.8067 4.91001 19.5C5.09001 19.1933 5.33335 18.95 5.64001 18.77C5.94668 18.59 6.28001 18.5 6.64001 18.5C7.00001 18.5 7.33335 18.59 7.64001 18.77C7.94668 18.95 8.19001 19.1933 8.37001 19.5C8.55001 19.8067 8.64001 20.14 8.64001 20.5C8.64001 20.86 8.55001 21.1933 8.37001 21.5C8.19001 21.8067 7.94668 22.05 7.64001 22.23C7.33335 22.41 7.00001 22.5 6.64001 22.5ZM18.64 22.5C18.28 22.5 17.9467 22.41 17.64 22.23C17.3333 22.05 17.09 21.8067 16.91 21.5C16.73 21.1933 16.64 20.86 16.64 20.5C16.64 20.14 16.73 19.8067 16.91 19.5C17.09 19.1933 17.3333 18.95 17.64 18.77C17.9467 18.59 18.28 18.5 18.64 18.5C19 18.5 19.3333 18.59 19.64 18.77C19.9467 18.95 20.19 19.1933 20.37 19.5C20.55 19.8067 20.64 20.14 20.64 20.5C20.64 20.86 20.55 21.1933 20.37 21.5C20.19 21.8067 19.9467 22.05 19.64 22.23C19.3333 22.41 19 22.5 18.64 22.5Z"
                                fill="#2563EB"></path>
                        </svg>
                        </div>
                    </div>
                    <div class="flex justify-center items-center flex-grow-0 flex-shrink-0 w-auto h-5 relative">
                        <p class="flex-grow-0 flex-shrink-0 text-sm font-medium text-center text-blue-800">
                            Order Food
                        </p>
                    </div>
                </a>
                <a href="{% url 'reservations:reservations' %}" class="flex flex-col justify-start items-center flex-1 h-[92px] min-w-[150px] p-4 rounded-lg bg-green-100 hover:bg-green-200 transition duration-300 cursor-pointer">
                    <div class="flex justify-start items-start flex-grow-0 flex-shrink-0 pb-2">
                        <div class="flex justify-center items-center flex-grow-0 flex-shrink-0 w-[25px] h-8 relative">
                            <svg width="26" height="24" viewBox="0 0 26 24" fill="none" xmlns="http://www.w3.org/2000/svg"
                                class="flex-grow-0 flex-shrink-0 w-[25px] h-6 absolute left-0 top-1" preserveAspectRatio="none">
                                <path
                                    d="M10 2V4H16V2H18V4H22C22.28 4 22.5167 4.09667 22.71 4.29C22.9033 4.48333 23 4.72 23 5V21C23 21.28 22.9033 21.5167 22.71 21.71C22.5167 21.9033 22.28 22 22 22H4C3.72 22 3.48333 21.9033 3.29 21.71C3.09667 21.5167 3 21.28 3 21V5C3 4.72 3.09667 4.48333 3.29 4.29C3.48333 4.09667 3.72 4 4 4H8V2H10ZM21 12H5V20H21V12ZM8 6H5V10H21V6H18V8H16V6H10V8H8V6Z"
                                    fill="#16A34A"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="flex justify-center items-center flex-grow-0 flex-shrink-0 w-auto h-5 relative">
                        <p class="flex-grow-0 flex-shrink-0 text-sm font-medium text-center text-green-800">
                            Make Reservation
                        </p>
                    </div>
                </a>
                <a href="{% url 'profile' %}" class="flex flex-col justify-start items-center flex-1 h-[92px] min-w-[150px] p-4 rounded-lg bg-purple-100 hover:bg-purple-200 transition duration-300 cursor-pointer">
                    <div class="flex justify-start items-start flex-grow-0 flex-shrink-0 pb-2">
                        <div class="flex justify-center items-center flex-grow-0 flex-shrink-0 w-[25px] h-8 relative">
                            <svg width="26" height="24" viewBox="0 0 26 24" fill="none" xmlns="http://www.w3.org/2000/svg"
                                class="flex-grow-0 flex-shrink-0 w-[25px] h-6 absolute left-0 top-1" preserveAspectRatio="none">
                                <path
                                    d="M11.8 14.24V16.24C10.72 16.24 9.71332 16.5133 8.77999 17.06C7.87332 17.5933 7.15332 18.3133 6.61999 19.22C6.07332 20.1533 5.79999 21.1667 5.79999 22.26H3.79999C3.79999 20.8067 4.16665 19.46 4.89999 18.22C5.60665 17.0067 6.55999 16.0467 7.75999 15.34C8.99999 14.6067 10.3467 14.24 11.8 14.24ZM11.8 13.24C10.72 13.24 9.71332 12.9733 8.77999 12.44C7.87332 11.9067 7.15332 11.1867 6.61999 10.28C6.07332 9.34666 5.79999 8.33666 5.79999 7.24999C5.79999 6.16332 6.07332 5.15332 6.61999 4.21999C7.15332 3.31332 7.87332 2.59332 8.77999 2.05999C9.71332 1.51332 10.7233 1.23999 11.81 1.23999C12.8967 1.23999 13.9067 1.51332 14.84 2.05999C15.7333 2.59332 16.4467 3.31332 16.98 4.21999C17.5267 5.15332 17.8 6.16332 17.8 7.24999C17.8 8.33666 17.5267 9.34666 16.98 10.28C16.4467 11.1867 15.7333 11.9067 14.84 12.44C13.9067 12.9733 12.8933 13.24 11.8 13.24ZM11.8 11.24C12.52 11.24 13.1867 11.0633 13.8 10.71C14.4133 10.3567 14.9 9.87332 15.26 9.25999C15.62 8.64666 15.8 7.97666 15.8 7.24999C15.8 6.52332 15.62 5.85332 15.26 5.23999C14.9 4.62666 14.4133 4.13999 13.8 3.77999C13.1867 3.41999 12.52 3.23999 11.8 3.23999C11.08 3.23999 10.4133 3.41999 9.79999 3.77999C9.18665 4.13999 8.69999 4.62666 8.33999 5.23999C7.97999 5.85332 7.79999 6.52332 7.79999 7.24999C7.79999 7.97666 7.97999 8.64666 8.33999 9.25999C8.69999 9.87332 9.18665 10.3567 9.79999 10.71C10.4133 11.0633 11.08 11.24 11.8 11.24ZM14.4 19.06C14.3333 18.7933 14.3 18.5233 14.3 18.25C14.3 17.9767 14.3333 17.7067 14.4 17.44L13.4 16.86L14.4 15.14L15.4 15.7C15.8 15.3267 16.2667 15.06 16.8 14.9V13.74H18.8V14.9C19.3333 15.06 19.8 15.3267 20.2 15.7L21.2 15.14L22.2 16.86L21.2 17.44C21.2667 17.7067 21.3 17.9767 21.3 18.25C21.3 18.5233 21.2667 18.7933 21.2 19.06L22.2 19.64L21.2 21.36L20.2 20.8C19.8 21.1733 19.3333 21.44 18.8 21.6V22.74H16.8V21.6C16.2667 21.44 15.8 21.1733 15.4 20.8L14.4 21.36L13.4 19.64L14.4 19.06ZM17.8 19.74C18.2133 19.74 18.5667 19.5967 18.86 19.31C19.1533 19.0233 19.3 18.67 19.3 18.25C19.3 17.83 19.1533 17.4767 18.86 17.19C18.5667 16.9033 18.2133 16.7567 17.8 16.75C17.3867 16.7433 17.0333 16.8867 16.74 17.18C16.4467 17.4733 16.3 17.83 16.3 18.25C16.3 18.67 16.4467 19.0267 16.74 19.32C17.0333 19.6133 17.3867 19.76 17.8 19.76V19.74Z"
                                    fill="#9333EA"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="flex justify-center items-center flex-grow-0 flex-shrink-0 w-auto h-5 relative">
                        <p class="flex-grow-0 flex-shrink-0 text-sm font-medium text-center text-purple-800">
                            Edit Profile
                        </p>
                    </div>
                </a>
                <a href="{% url 'core:contact' %}" class="flex flex-col justify-start items-center flex-1 h-[92px] min-w-[150px] p-4 rounded-lg bg-amber-100 hover:bg-amber-200 transition duration-300 cursor-pointer">
                    <div class="flex justify-start items-start flex-grow-0 flex-shrink-0 pb-2">
                        <div class="flex justify-center items-center flex-grow-0 flex-shrink-0 w-[25px] h-8 relative">
                            <svg width="26" height="24" viewBox="0 0 26 24" fill="none" xmlns="http://www.w3.org/2000/svg"
                                class="flex-grow-0 flex-shrink-0 w-[25px] h-6 absolute left-0 top-1" preserveAspectRatio="none">
                                <path
                                    d="M23 16.5799C23 17.5133 22.7933 18.3999 22.38 19.2399C21.98 20.0399 21.42 20.7233 20.7 21.2899C19.98 21.8566 19.1733 22.2399 18.28 22.4399L17.64 20.5199C18.24 20.4266 18.7867 20.2066 19.28 19.8599C19.7733 19.5133 20.1667 19.0799 20.46 18.5599H18C17.64 18.5599 17.3067 18.4733 17 18.2999C16.6933 18.1266 16.45 17.8866 16.27 17.5799C16.09 17.2733 16 16.9333 16 16.5599V12.5599C16 12.1999 16.09 11.8666 16.27 11.5599C16.45 11.2533 16.6933 11.0099 17 10.8299C17.3067 10.6499 17.64 10.5599 18 10.5599H20.94C20.78 9.26661 20.3267 8.08661 19.58 7.01994C18.8333 5.95328 17.8933 5.11328 16.76 4.49994C15.5867 3.87328 14.3333 3.55994 13 3.55994C11.6667 3.55994 10.4133 3.87328 9.24 4.49994C8.10667 5.11328 7.16667 5.95328 6.42 7.01994C5.67333 8.08661 5.22 9.26661 5.06 10.5599H8C8.36 10.5599 8.69333 10.6499 9 10.8299C9.30667 11.0099 9.55 11.2533 9.73 11.5599C9.91 11.8666 10 12.1999 10 12.5599V16.5599C10 16.9333 9.91 17.2733 9.73 17.5799C9.55 17.8866 9.30667 18.1266 9 18.2999C8.69333 18.4733 8.36 18.5599 8 18.5599H5C4.64 18.5599 4.30667 18.4733 4 18.2999C3.69333 18.1266 3.45 17.8866 3.27 17.5799C3.09 17.2733 3 16.9333 3 16.5599V11.5599C3 10.2133 3.26 8.91994 3.78 7.67994C4.28667 6.47994 5.00333 5.41994 5.93 4.49994C6.85667 3.57994 7.91333 2.86661 9.1 2.35994C10.34 1.82661 11.64 1.55994 13 1.55994C14.36 1.55994 15.66 1.82661 16.9 2.35994C18.0867 2.86661 19.1433 3.57994 20.07 4.49994C20.9967 5.41994 21.7133 6.47994 22.22 7.67994C22.74 8.91994 23 10.2133 23 11.5599V16.5799ZM21 16.5599V12.5599H18V16.5599H21ZM5 12.5599V16.5599H8V12.5599H5Z"
                                    fill="#D97706"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="flex justify-center items-center flex-grow-0 flex-shrink-0 w-auto h-5 relative">
                        <p class="flex-grow-0 flex-shrink-0 text-sm font-medium text-center text-amber-800">
                            Contact Support
                        </p>
                    </div>
                </a>
            </div>
        </div>

    </div>
{% endblock dashboard_content %}
